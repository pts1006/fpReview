// 학번 이메일 있는지 체크
function check() {
  const email = $("#email-for-pass").val();
  const sid = $("#sid-for-pass").val();

  if (sid == null || sid === undefined || sid == "") {
    alert("학번을 입력해주세요");
    $("#sid-for-pass").focus();
  } else if (email == null || email === undefined || email == "") {
    alert("이메일을 입력해주세요");
    $("#email-for-pass").focus();
  } else {
    alert("학번 및 이메일 체크");
    $.ajax({
      url: "forgetChkEmail",
      type: "POST",
      dataType: "json",
      data: {
        email: email,
        sid: sid,
      },
      success: function (result) {
        
        $("#sname").val(result.sname);
        $("#forgetPwdAuth").submit();
      },
      error: function (err) {
        console.log(err);
        alert("존재하지 않는 학번 또는 이메일 입니다.");
      },
    });
  }

}

// 인증번호가 맞는지 체크
function authCheck(num) {
  const authNum = $("#authNum").val();

  if (num == authNum) {
    $("#forgetPwdNew").submit();
  } else {
    alert("인증번호가 틀립니다.");
    $("#authNum").focus();
  }
}



// 비밀번호 변경 ajax
function newPwdCheck(sid) {
  const pwd = $("#pwd").val();
  const pwdChk = $("#pwdChk").val();

	// 정규식 = 대문자, 특수문자가 반드시 하나 이상 포함된 최소 6글자 비밀번호 (한글 x)
	const idReg = /^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{6,}/;
	
	if (!idReg.test(pwd) || !idReg.test(pwdChk)) {
		alert('비밀번호 조건이 맞지 않습니다!');
		$('#pwd').focus();
		return false;
	}

  if (pwd != pwdChk) {
    alert("비밀번호가 같지않습니다!");
    $("#pwd").focus();
  } else {
    $.ajax({
      url: "forgetNewPwd",
      type: "post",
      dataType: "text",
      data: {
        pwd: pwd,
        sid: sid,
      },
      success: function (result) {
        console.log(result);
        if (result == "yes") {
          alert("비밀번호 변경 성공!!");
          location.href = "goLogin";
        } else {
          alert("비밀번호 변경 에러.");
          location.href = "goLogin";
        }
      },
      error: function (err) {
        console.log(err);
      },
    });
  }
}
